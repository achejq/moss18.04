#
# This file MUST be edited with the 'visudo' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#


## OS
Cmnd_Alias OS = /usr/bin/vi, /bin/cat, /bin/more, /usr/bin/less, /usr/bin/tail, /bin/grep, /bin/egrep, /usr/bin/awk, /bin/sed, /bin/find, /usr/bin/find, /usr/bin/xargs, /bin/echo

## Networking
Cmnd_Alias NETWORK = /sbin/route, /sbin/ifconfig, /bin/ping, /sbin/iptables, /sbin/mii-tool, /bin/netstat, /usr/bin/traceroute, /usr/bin/mrt, /bin/ss, /bin/ip

## Installation and management of software
Cmnd_Alias SOFTWARE = /usr/bin/apt, /usr/bin/apt-add-repository, ,/usr/bin/apt-cache, /usr/bin/cdrom, /usr/bin/apt-config, /usr/bin/apt-extracttemplates, /usr/bin/apt-ftparchive, /usr/bin/apt-get, /usr/bin/apt-key, /usr/bin/apt-mark, /usr/bin/apt-sortpkgs

## Services
Cmnd_Alias SERVICES = /usr/sbin/service, /bin/systemctl, /usr/bin/hostnamectl

## Storage
Cmnd_Alias STORAGE = /sbin/fdisk, /sbin/sfdisk, /sbin/parted, /sbin/partprobe, /bin/mount, /bin/umount

## Delegating permissions
Cmnd_Alias DELEGATING = /bin/chown, /bin/chmod, /bin/chgrp

## Processes
Cmnd_Alias PROCESSES = /usr/bin/nice, /usr/bin/renice, /bin/kill, /usr/bin/kill, /usr/bin/killall, /bin/ps, /usr/bin/pstree

## Debug
Cmnd_Alias DEBUG = /usr/bin/top, /usr/sbin/iotop, /usr/bin/iostat, /usr/bin/vmstat, /usr/bin/sar, /usr/bin/free, /usr/sbin/dmidecode, /usr/bin/strace, /usr/sbin/iptraf-ng, /usr/bin/lsof, /usr/sbin/tcpdump


Defaults    env_reset
Defaults    mail_badpass
Defaults    secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin"

# Host alias specification

# User alias specification

# Cmnd alias specification

# User privilege specification
root    ALL=(ALL:ALL) ALL

# Members of the admin group may gain root privileges
%admin ALL=(ALL) ALL

# Allow members of group sudo to execute any command
%sudo   ALL=(ALL:ALL) ALL

%sa     ALL=(root)  NOPASSWD: OS, NETWORK, SOFTWARE, SERVICES, STORAGE, DELEGATING, PROCESSES, DEBUG

%wheel  ALL=(ALL:ALL)   NOPASSWD: ALL

# See sudoers(5) for more information on "#include" directives:

#includedir /etc/sudoers.d
